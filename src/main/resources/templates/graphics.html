<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">

  <head th:replace="layout/layout :: head"></head>

  <header th:replace="layout/layout :: header"></header>

<body>


<div class="container-sm" >

  <h1 th:text="${titulo}"></h1>

  <form action="" method="POST" class="form-row mb-4">
    <div class="col">
      <label for="rango_mes">Mes</label>
      <input type="month" name="fecha" id="rango_mes" class="form-control" value="2023-01" onchange="pasarFecha()">
    </div>
  </form>
  <div class="row align-items-start">
    <div class= "col"  >
      <h2 align="right" >
        Ventas $  <span class="badge badge-pill badge-secondary" id="total_ventas"   style="background:#2C3E50;" onload="pasarFecha()" >0</span>
      </h2>
    </div>

    <div class= "col"  >
      <h2 align="right" >
        Profit $  <span class="badge badge-pill badge-secondary" id="total_profit"style="background:#2C3E50;">0</span>
      </h2>
    </div>

    <div class= "col"  >
      <h2 align="right" >
        Egresos $  <span class="badge badge-pill badge-secondary" id="total_egresos" style="background:#2C3E50;" >0</span>
      </h2>
    </div>


  </div>
  <div id="columnchart_material" style="width: 800px; height: 500px;"></div>
</div>

<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

 google.charts.load('current', {'packages':['bar']});
  google.charts.setOnLoadCallback(pasarFecha);



var total_ventas = [];
  var total_profit = [];
function pasarFecha(){//----SE GATILLA AL HACER CLICK EN UN BOTON---

         var cota=$("#rango_mes").val(); //---OBTENGO EL VALOR DE UN CAMPO TEXT INPUT---
                $.ajax({
                    url: '/bonjour/estadisticas/getestadisticas/'+ cota,
                    type: 'GET',
                    dataType: 'json',
                    data: {c:cota},
                })
                .done(function(data) {
total_ventas.length=0;
total_profit.length=0;

                    for (var item of data) {

total_ventas.push(1);
total_ventas.push(item.total_beneficio);
total_ventas.push(item.total_profit);
total_ventas.push(4999);

                    }


                });


this.drawChart();
    }


      function drawChart() {

        var data = google.visualization.arrayToDataTable([
          ['Year', 'Sales', 'Expenses', 'Profit'],
          total_ventas

        ]);

        var options = {
          chart: {
            title: 'Company Performance',
            subtitle: 'Sales, Expenses, and Profit: 2014-2017',
          }
        };
total_ventas.length=0;
total_profit.length=0;
        var chart = new google.charts.Bar(document.getElementById('columnchart_material'));

        chart.draw(data, google.charts.Bar.convertOptions(options));
      }
    </script>

<footer th:replace="layout/layout :: footer"></footer>
</body>

</html>